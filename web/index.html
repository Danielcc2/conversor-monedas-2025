<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Viaja y Convierte Divisas</title>
    <style>
      :root { --bg: #0b1220; --panel: #0f172a; --text: #e5e7eb; --muted: #9ca3af; --primary: #10b981; --accent: #22d3ee; }
      * { box-sizing: border-box; }
      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial; background: radial-gradient(1200px 600px at 20% 10%, rgba(34,211,238,.12), transparent), radial-gradient(900px 500px at 80% 20%, rgba(16,185,129,.12), transparent), var(--bg); color: var(--text); margin: 0; }
      .wrap { max-width: 980px; margin: 0 auto; padding: 40px 20px; }
      header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
      .brand { display: flex; gap: 10px; align-items: center; font-weight: 700; letter-spacing: .3px; }
      .brand .logo { width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, var(--primary), var(--accent)); display: grid; place-items: center; color: #052e2b; font-weight: 900; }
      .hero { display: grid; grid-template-columns: 1.2fr 1fr; gap: 24px; align-items: center; }
      .hero h1 { font-size: 2rem; line-height: 1.2; margin: 0 0 10px; }
      .hero p { color: var(--muted); margin: 0 0 16px; }
      .card { background: var(--panel); border: 1px solid #1f2937; border-radius: 14px; padding: 18px; box-shadow: 0 12px 30px rgba(0,0,0,.25); }
      label { font-size: .9rem; color: var(--muted); display: block; margin: 8px 0 6px; }
      input, button { width: 100%; padding: 12px 14px; border-radius: 10px; border: 1px solid #1f2937; background: #0b1220; color: var(--text); }
      input:focus, button:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37,99,235,.25); }
      button.primary { background: var(--primary); color: #052e2b; border: none; font-weight: 700; cursor: pointer; margin-top: 12px; }
      .two { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
      .hint { color: var(--muted); font-size: .9rem; }
      .illu { aspect-ratio: 4/3; border-radius: 14px; border: 1px solid #1f2937; background: linear-gradient(135deg, rgba(34,211,238,.15), transparent), url('https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?q=80&w=1200&auto=format&fit=crop') center/cover no-repeat; box-shadow: 0 12px 30px rgba(0,0,0,.25); }
      @media (max-width: 900px) { .hero { grid-template-columns: 1fr; } .illu { order: -1; height: 220px; } }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div class="brand"><div class="logo">✈︎</div> Blog Viajes 2025</div>
        <nav class="hint">Convierte divisas para tu próximo viaje</nav>
      </header>

      <section class="hero">
        <div>
          <h1>Planifica tu próximo viaje con divisas claras</h1>
          <p>Regístrate o inicia sesión para guardar tus preferencias y convertir divisas al instante. Sin complicaciones, con estilo viajero.</p>
          <div class="two">
            <div class="card">
              <h3>Iniciar sesión</h3>
              <label for="loginEmail">Email</label>
              <input id="loginEmail" type="email" placeholder="tú@correo.com" />
              <label for="loginPass">Contraseña</label>
              <input id="loginPass" type="password" placeholder="••••••••" />
              <button id="loginBtn" class="primary">Entrar</button>
            </div>
            <div class="card">
              <h3>Crear cuenta</h3>
              <label for="regName">Nombre de viajero</label>
              <input id="regName" type="text" placeholder="Aventurero/a" />
              <label for="regEmail">Email</label>
              <input id="regEmail" type="email" placeholder="tú@correo.com" />
              <label for="regPass">Contraseña</label>
              <input id="regPass" type="password" placeholder="••••••••" />
              <button id="regBtn" class="primary">Registrarme</button>
              <p class="hint">Al registrarte se creará tu espacio personal y te llevaremos al conversor.</p>
            </div>
          </div>
        </div>
        <div class="illu" aria-hidden="true"></div>
      </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      const SUPABASE_URL = 'https://ubqsbofiyhearumlmdif.supabase.co';
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVicXNib2ZpeWhlYXJ1bWxtZGlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1MjczNzUsImV4cCI6MjA3MzEwMzM3NX0.CpXG7JL7sOb1Rdn0BMyqN9MxsV13UMpSwazuhQt8jlE';
      const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      window.sb = supabase; // Exponer cliente para depuración en consola
      const $ = (id) => document.getElementById(id);
      function slugify(name){ return String(name||'').toLowerCase().trim().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); }

      async function register(){
        const name = $('regName').value.trim();
        const email = $('regEmail').value.trim().toLowerCase();
        const pass = $('regPass').value;
        if(!name || !email || !pass){ alert('Completa todos los campos'); return; }
        const { data, error } = await supabase.auth.signUp({
          email,
          password: pass,
          options: { data: { name } }
        });
        if (error) { alert('Error al registrar: ' + error.message); return; }
        const slug = slugify(name);
        if (data.session) {
          history.replaceState({}, '', `#/viajero/${slug}`);
          location.href = '/divisas?user=' + encodeURIComponent(slug);
        } else {
          alert('Revisa tu correo para confirmar el registro.');
        }
      }

      async function login(){
        const email = $('loginEmail').value.trim().toLowerCase();
        const password = $('loginPass').value;
        const { data, error } = await supabase.auth.signInWithPassword({ email, password });
        if (error) { alert('Credenciales inválidas'); return; }
        // Intentar obtener nombre del perfil si existe
        const { data: userData } = await supabase.auth.getUser();
        const name = userData?.user?.user_metadata?.name || email.split('@')[0];
        const slug = slugify(name);
        history.replaceState({}, '', `#/viajero/${slug}`);
        location.href = '/divisas?user=' + encodeURIComponent(slug);
      }

      $('regBtn').addEventListener('click', register);
      $('loginBtn').addEventListener('click', login);
    </script>
  </body>
  </html>
